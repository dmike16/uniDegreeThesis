\chapter{Evoluzione Geometrica Per Curvatura Media}
\label{cap:cap1}
In questa sezione richiamiamo la definizione di superfice in forma
level-set e introduciamo il moto per curvatura media per superfici,
devirandone un sua formulazione che preserva il volume, per uteriori
dettagli si veda \cite[][]{gui:sapiro,sapiro:tann}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Section 1.1
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Superfici in rappresentazione \emph{level-set}}
\label{sec:cp1-00}
Un insieme $S\subset\mathbb{R}^3$ è chiamato superfice di classe $C^m$ (o ipersuperficie se siamo in $\mathbb{R}^N$ con $N>3$) intorno ad un punto $x_0$ di $S$ se esiste una funzione $u(x)$ di classe $C^m$ definita in un intorno $U$ di $x_0$ tale che
\[
S\cap U=\left\{x\in U; u(x)=0\right\}
\]
e il gradiente di $u$
\[
 Du=\left(\frac{\partial u}{\partial x_1},\dots,\frac{\partial u}{\partial x_3}\right)
\]
non svanisce su $S$. Tale rappresentazione è chiamta \emph{level-set}. Se $u$ può essere presa $C^{\infty}$ in $U$, diremo che la superficie $S$ è regolare intorno ad $x_0$ e se $u$ è anche definita intorno ad ogni punto di $x_0\in S$, allora si parla semplicemetne di superficie regolare. Questa rappresentazione può essere estesa anche ad insiemi dipendenti dal tempo. Difatti diremo che una famiglia $S_t$ è una superficie regolare che si evolve nel tempo se esiste una funzione $u(x.t)$ definita per ogni $x\in S_t$ e $t\in I$ tale che:
\[
S_t=\left\{x\in S_t; u(x,t)=0\right\},
\]
e tale che il gradiente spaziale di $u$ non svanisca su $S_t$.
\begin{osservazione}
 La superfice può essere rappresentata anche tramite cordinate locali. Un sottoinsieme $S\subset\mathbb{R}^3$ rappresenta una superficie intorno ad un punto $x_0$ di $S$, attraverso l'immagine $\varphi(U^{'})$ di una qualche mappa $\varphi$ di classe $C^m$ da un insieme aperto $U^{'}\subset\mathbb{R}^2$ in $\mathbb{R}^3$ con rango massimo, cioè la matrice Jacobiana $\nabla\varphi$ ha le colonne linearmenti indipendenti.
L'equivalenza tra le due rappresentazioni è garantita dal teorema della funzione implicita.
\end{osservazione} 

Supponiamo che $S$ sia una superfice intorno a $x_0\in S$. Un vettore $\tau\in\mathbb{R}^3$ è chiamato \emph{vettore tangente} di $S$ in $x_0$, se esiste una curva $\zeta\in C^1$ su $S$ tale che $\zeta = x_0$ e $d\zeta(t)/dt = \tau$ in $t=0$, dove $\zeta$ è definita almeno in un intorno di $0$. Lo spazio dei vettori tangenti in $x_0$ è chiamato \emph{spazio tangente} di $S$ in $x_0$ ed è denotato con $T_{x_0}S$. Un \emph{vettore unitario normale} $\vec{n}(x_0)$ in $x_0$ a $S$ è un vettore di $\mathbb{R}^3$ con norma uno ortogonale al $T_{x_0}S$, ed è unico a meno del segno. Se $\vec{n}(x)$ è un vettore normale unitario in $x$ vicino $x_0$ e esso dipende da $x$ in modo almeno continuo, diremo che $\vec{n}$ è un campo unitario normale di orientazione (attorno a $x_0$) di $S$. Vediamo che esiste almeno in un intorno di $x_0$. Per $x\in S\cap U$ sia $\zeta(t)$ una curva su $S$ tale che $\zeta(0)=x$. Deriviamo $u(\zeta(t)) = 0$ e cancoliamolo in $t=0$
\[
\left<Du(x),\frac{d\zeta}{dt}(0)\right> = 0.
\]
Questo ci dice che il gradiente in $x$ di $u$ è ortogonale al piano tangente a $S$ in $x$. Per la formulazione level-set $u\in C^m$ , $Du\in C^{m-1}$ ($m>0$) quindi almeno continua e $Du$ non svanisce intorno a $x_0$; quindi
\[
\vec{n}(x)=-\frac{Du(x)}{|Du(x)|},
\]
è un campo vettoriale unitario di orientazione intorno ad $x_0$. Il segno meno è per fissare le idee. Quindi lo spazio tangente per $x\in S$ intorno a $x_0$ è dato da
\[
T_xS = \left\{\tau\in\mathbb{R}^3;<\tau,\vec{n}(x)>=0\right\}.
\]

\begin{figure}[!hp]
  \tdplotsetmaincoords{60}{40}
  \begin{tikzpicture}[tdplot_main_coords,gray,thick]

    \coordinate (O) at (0,0,0);

    \tdplotsetcoord{P}{1.5}{90}{240};
    \tdplotsetcoord{P1}{2.5}{90}{105};
    \tdplotsetcoord{P2}{2.7}{90}{-30};
    \tdplotsetcoord{P3}{3.4}{90}{45}

    
    \draw[->,Mahogany!80!Mulberry] (0,0,0)node[anchor=east]{$x$} -- 
    (2,0,0) node[anchor=south]{${\tau}^2$};
    \draw[->,Mahogany!80!Mulberry] (0,0,0) -- (0,2,0) node[anchor=north]{${\tau}^1$};
    \draw[->,Mahogany!80!Mulberry] (0,0,0) -- (0,0,2.5) node[anchor=north east]{$\vec{n}$};
    
    \draw (P) -- (P1) -- (P3) -- (P2) -- (P);
    
    \tdplotsetcoord{W}{6}{90}{281}
    \tdplotsetcoord{W1}{6.5}{90}{91}
    \tdplotsetcoord{W2}{6}{90}{318}
    \tdplotsetcoord{W3}{5.5}{90}{25}
    
    \draw (W) .. controls (-2,0,0) and (-2,1,0) .. (W1);
    \draw (W2) .. controls (3,0,0) and (3,0.5,0) .. (W3);
    \draw (W) to[out=60,in=60] (W2);
    \draw (W) to[out=240,in=240](W2);
    \draw (W1) to[out=190,in=190] (W3);
    \draw (W1) to[out=10,in=10] (W3);

  \end{tikzpicture}

  \caption{Piano tangente e versore normale alla superficie $S$ nel punto $x$.}
  \label{fig:cp-111}
\end{figure}

Sia $S$ una superfice in $\mathbb{R}^3$, per un punto $x_0$ sia $\tau$ un vettore tangente di $S$ in $x_0$ e sia $X$ un campo vettoriale $C^1$ su $S$ intorno a $x_0$. Qui $C^1$ vuol dire che può essere esteso ad una funzione $C^1$ in un intorno di $x_0$ in $\mathbb{R}^3$. Sia $\zeta$ una curva su $S$ tale che
\[
\zeta(0)=x_0,\quad\frac{d\zeta(t)}{dt}=\tau,
\]
la derivata tangenziale nella direzione $\tau$ è così definita
\[
(D_{\tau}X)(x_0)=\frac{d}{dt}\left(X(\zeta(t))\right)_{|_{t=0}}.
\]
Se $X$ è esteso in un intorno di $x_0$ in $\mathbb{R}^3$, allora essendo $C^1$ è ben definita la matrice $3\times 3$ jacobiana $\nabla X$, quindi
\begin{equation}
\label{eq:cp1-1-01}
(D_{\tau}X)(x_0)=(\tau\cdot\nabla)X=\sum_{j=1}^3\tau_j\frac{\partial}{\partial x_j}X,\quad\tau=(\tau_1,\tau_2,\tau_3).
\end{equation}
Questo mostra che l'operatore $D_{\tau}$ è indipendente dalla scelta della curva $\zeta$ e vista la definizione di $D_{\tau}$ è anche indipendente dall'estensione di $X$ fuori da $S$; quindi è ben definito per ogni campo vettoriale su $S$.
Ora supponiamo che $S$ è una superficie $C^2$ intorno ad $x\in S$ e sia $\vec{n}(x)$ il campo unitario normale intorno a $x$ il quale, per quanto detto alcune righe sopra, risulta essere $C^1$ su $S$. Per ogni $\tau\in T_xS$ poniamo
\begin{equation}
\label{eq:cp1-1-02}
\vec{A}\tau=-D_{\tau}\vec{n}\in\mathbb{R}^3.
\end{equation}
Iniziamo ad osservare che, poichè $|\vec{n}|=1$ allora
\[
\left<\vec{A}\tau,\vec{n}\right>=-\frac{1}{2}D_{\tau}(|n|^2)=0,
\]
quindi $\vec{A}\tau\in T_xS$. L'operatore lineare $\vec{A}=\vec{A}_x$ da $T_xS$ in se stesso è chiamato \emph{Weingarten map} nella direzione $\vec{n}(x)$. La forma bilineare da $T_xS\times T_xS$ associata ad $\vec{A}$ definita da
\begin{equation}
\label{eq:cp1-1-03}
B_x(\tau,\eta)=\left<\vec{A}\tau,\eta\right>
\end{equation}
è chiamata la \emph{seconda forma fondamentale} (nella direzione di $\vec{n}(x)$) in $x\in S$. Per vedere il significato geometrico di $B_x$, per $\tau,\eta\in  T_xS$ sia $\phi$ una funzione  definita da un intorno dell'origine di $\mathbb{R}^2$ in $S\subset\mathbb{R}^3$ tale che
\[
\frac{\partial\phi}{\partial x_1}(0,0)=\tau,\quad\frac{\partial\phi}{\partial x_2}(0,0)=\eta,\quad\phi(0,0)=x.
\]
Poichè
\begin{equation}
\label{eq:cp1-1-04}
\left<\vec{n}(\phi(x_1,x_2)),\frac{\partial\phi}{\partial x_1}(x_1,x_2)\right>=0,
\end{equation}
per $(x_1,x_2)$ vicini a $(0,0)$, derivando per $x_2$  otteniamo
\[
\left<(\eta\cdot\nabla)\vec{n},\tau\right>+\left<\vec{n},\frac{\partial^2\phi}{\partial x_1\partial x_2}\right> = 0,
\]
quindi
\[
B_x(\eta,\tau)=\left<\vec{n},\frac{\partial^2\phi}{\partial x_1\partial x_2}\right>
\]
In particolare, ripetendo il calcolo con $\partial\phi/\partial x_2(x_1,x_2)$ in \eqref{eq:cp1-1-04} e derivando per $x_1$, si dimostra che la forma bilineare è simmetrica e che la mappa di Waingarten è anche essa simmetrica. Per cui esiste un base ortonormale in cui è diagonalizzabile, i suoi autovalori sono tutti reali e sono chiamati le \emph{curvature principali} di $S$ in $x$. Derivando \eqref{eq:cp1-1-04} in $x_1$ ed calcolandola in $(0,0)$ otteniamo
\[
B_x(\tau,\tau)=\left<\vec{n},\frac{\partial^2\phi}{\partial x_1^2}(0,0)\right>
\]
se $|\tau|=1$, questa quantità è chiamata \emph{curvatura normale} di $S$ nella direzione $\tau$. Sia $x\in S$, $\{\tau^l;l=1,2\}$ una base ortonormale di $T_xS$ ed  $X$ un campo vettoriale $C^1$ su $S$. Definiamo la \emph{divergenza di superficie} di $X$ come
\[
(\Div_S X)(x) = \sum_{l=1}^2\left<(D_{\tau^l}X(x),\tau^l\right>.
\]
Se estendiamo $X$ intorno a $S$ così che $\nabla X$ è ben definita come una matrice $3\times 3$, allora otteniamo
\[
\begin{aligned}
(\Div_S X)(x)&=\sum_{l=1}^2\left<\sum_{j=1}^3\tau_j^l\frac{\partial}{\partial x_j}X(x),\tau^l\right> =\sum_{l}\sum_{j}\left<\frac{\partial}{\partial x_j}X(x),\tau_j^l\tau^l\right> \\
&=\sum_{l}\sum_{j}(\tau_j^l\tau^l)\left(\frac{\partial}{\partial x_j}X(x)\right)^t=\trace\left(\left(\sum_{l=1}^2\tau^l\otimes\tau^l\right) (\nabla X(x))^t\right)
\end{aligned}
\]
con $\otimes$ prodotto tensoriale. La definizione di $\Div_S X$ è indipendente dall'estensione di $X$, quindi l'espressione precedente è indipendente dall'estensione di $X$. Sfruttando che (vedi \emph{osservazione} \ref{oss:cp1-1-01})
\begin{equation}
\label{eq:cp1-1-05}
\sum_{l=1}^2\tau^l\otimes\tau^l = I_3 - \vec{n}(x)\otimes\vec{n}(x)
\end{equation}
abbiamo
\begin{equation}
(\Div_S X)(x)=\trace\left(\left(I_3 - \vec{n}(x)\otimes\vec{n}(x)\right) (\nabla X(x))^t\right)
\end{equation}
dalla quale si evince che la divergenza di superfice è indipendente dalla scelta della base ortonormale di $T_xS$ e dall'orientazione di $\vec{n}(x)$.
Ora, sia $\vec{n}$ un campo unitario normale su una $C^2$ superfice $S$ e $k_1(x),k_2(x)$ le sue curvature principali in $x$ nella direzione $\vec{n}$, cioè gli autovalori della mappa di Weigarten in un base ortonormale $\{\tau^l;l=1,2\}$ di $T_xS$. Si definiscono \emph{curvatura media}\footnote{In alcuni testi è definita coma la media delle curvature principali, quindi differisce dalla nostra defnizione solo per un fattore moltiplicativo. \cite[][]{giga:main}.} \,%
 e \emph{curvatura gaussiana} rispettivamente,
\begin{equation}
\label{eq:cp-1-1-06}
H=k_1+k_2,\quad K=k_1k_2.
\end{equation}
Soffermiamoci sull'espressine della curvatura media, che ci sarà utile in seguito, e vediamo come possiamo riscriverla. Sfruttando la \eqref{eq:cp1-1-02},  \eqref{eq:cp1-1-03} e \eqref{eq:cp1-1-05}
\[
\begin{aligned}
H &= k_1+k_2 = \sum_{l=1}^2B_x(\tau_l,\tau_l)=-\sum_{l}\left<D_{\tau^l}\vec{n}(x),\tau^l\right>=-\Div_{S}\vec{n}(x)=\\
&=-\trace\left(\left(I_3 - \vec{n}(x)\otimes\vec{n}(x)\right) (\nabla \vec{n}(x))^t\right)=-\Div\left(\vec{n}(x)\right)+\\
+&\trace\left(\vec{n}(x)\otimes\vec{n}(x) (\nabla \vec{n}(x))^t\right)=-\Div\left(\vec{n}(x)\right)+ \sum_{j=1}^3n_j\left<\vec{n}(x),\frac{\partial}{\partial x_j}\vec{n}(x)\right>\\
&=-\Div\left(\vec{n}(x)\right)+\sum_{j=1}^3n_j\frac{1}{2}\frac{\partial}{\partial x_j}(|\vec{n}(x)|^2)=-\Div(\vec{n}(x)),
\end{aligned}
\]
quindi
\begin{equation}
\label{eq:cp1-1-07}
H=-\Div\left(\vec{n}(x)\right),
\end{equation}
e poiche  $\vec{n}(x)=-Du/|Du|$, otteniamo
\[
H=\Div\left(\frac{Du}{|Du|}\right)(x).
\]
\begin{osservazione}
\label{oss:cp1-1-01}
Sia $S$ una $C^2$ superfice intorno ad un punto $x_0\in S$,  $\vec{n}$
un vettore unitario normale intorno ad $x_0$ e $\{\tau^l;l=1,2\}$ una
base ortonormale di $T_xS$ . Vogliamo dimostrare l'uguaglianza \eqref{eq:cp1-1-05}. Prendiamo $\theta\in\mathbb{R}^3$ e vediamo come agiscono le due matrici su tale vettore.
\[
\begin{aligned}
&\left(\sum_{l=1}^2\tau^l\otimes\tau^l\right)\theta = \sum_l\underbrace{\left(\sum_{j=1}^3\theta_j\tau_j^l\right)}_{{}=\alpha_l}\tau^l=\nu \in T_{x_0}S\\
&\left(I_3-\vec{n}(x_0)\otimes\vec{n}(x_0)\right)\theta = \theta - \left(\sum_{j=1}^3\theta_jn_j\right)\vec{n}(x_0)=\nu' 
\end{aligned}
\]
osserviamo che, da calcolo diretto, $<\nu',\vec{n}(x_0)>=0$ quindi questo ci dice che anche $\nu'\in T_{x_0}S$, cioè esistono dei $\beta_l$ tale che $\nu'=\sum_{l=1}^2\beta_l\tau^l$. Inoltre si può dimostrare, con un semplice calcolo, che entrambe le matrici quando vengono moltiplicate per un generico vettore $\tau\in T_{x_0}S$ (quindi che già appartiene allo spazio tangente) danno come risultato $\tau$ stesso. Quindi possiamo dire che le due matrici proiettano un vettore di $\mathbb{R}^3$ nello spazio tangente. Per dimostrare l'uguaglianza tra loro, basta provare che $\nu=\nu'$ questo è vero se e solo se $\alpha_l=\beta_l\,\forall l$. Ricordando che $\alpha_l=<\theta,\tau^l>$, calcoliamoci il genrico $\beta_l$
\[
\beta_l=<\nu',\tau^l>=<\theta,\tau^l>-\left(\sum_{j=1}^3\theta_jn_j\right)<\vec{n}(x_0),\tau^l>=\alpha_l
\]
questo conclude la dimostrazione.
\end{osservazione}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Section 1.2
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Moto per curvatura media \emph{Volume Preserving}}
\label{sec:cp1-sc2}
Consideriamo superfici che si evolvono nel tempo. Utilizziamo, inizialmente la rappresentazione parametrica. Sia $\mathcal{S}(\tilde{p},t):U\times[0,T)\longrightarrow\mathbb{R}^3$, con $U\subseteq\mathbb{R}^2$, una famiglia di superfici regolari, dove $t$ parametrizza la famiglia e $\tilde{p}$ la superficie. Assumiamo che essa obedisce alla seguente equazione alle derivate parziali:
\begin{equation}
  \label{eq:cp121}
  \frac{\partial\mathcal{S}(\tilde{p},t)}{\partial t} = \alpha(\tilde{p},t)\vec{t}(\tilde{p},t) + \beta(\tilde{p},t)\vec{n}(\tilde{p},t)
\end{equation}
con $\mathcal{S}_0(\tilde{p})$ condizione iniziale. Indichiamo con $\vec{t}$ e $\vec{n}$ ripsettivamente, il versore tangente e il versore normale interno alla superficie; mentre $\alpha$ e $\beta$ sono le componenti tangenziale e normale della velocità con cui si deforma la superfcie. L'equazione scritta sopra risulta essere molto generale, infatti notiamo che per una qualsiasi velocità di deformazione $\vec{V}$ si ha $\alpha=<\vec{V},\vec{t}>$ e $\beta=<\vec{V},\vec{n}>$. Essendo interessati alla sola deformazione geometrica e non a come cambia la parametrizzazione, l'equazione \eqref{eq:cp121} può essere semplificata applicando il seguente lemma:
\begin{lemma}
\label{lemm:cp-121}
Se $\beta$ non dipende dalla parametrizzazione, ma è una caratteristica geometrica intrinseca della superficie, tipo la curvatura, allora l'imagine di $\mathcal{S}(\tilde{p},t)$ che soddisfa \eqref{eq:cp121} è identica all'imagine della famiglia $\mathcal{S}(p,t)$ che soddisfa
\begin{equation}
  \label{eq:cp122}
  \frac{\partial\mathcal{S}(p,t)}{\partial t} =\beta(p,t)\vec{n}(p,t).
\end{equation}
\end{lemma}

Per la dimostrazione del lemma si veda \cite[][]{gui:sapiro}, soffermiamoci qui solo sulle conseguenze.
In poche parole, se la componente normale della velocità dipende soltato da caratteristiche geometriche della curva, l'evoluzione della famiglia è influenzata solo da quest'ultima componente; mentre la componente tangenziale influisce esclusivamente sulla parametrizzazione.
Consideriamo ora un flusso geometrico di superfici della forma:
\[
\frac{\partial\mathcal{S}}{\partial t} = \beta(H)\vec{n},
\] 
dove la velocità $\beta$ è una funzione della curvatura media. In particolare se $\beta(H)=H$ l'equazione precedente diventa:
\begin{equation}
  \label{eq:cp-123}
  \frac{\partial\mathcal{S}}{\partial t} = \vec{V} = H\vec{n}
\end{equation}
con $\mathcal{S}(p,0)=S_0$ dato iniziale.
\begin{osservazione}
Questo flusso è quello che in letteratura viene chiamato
flusso per curvatura media e fa evolvere la  superficie cercando di
minimizzare l'area.  
\end{osservazione}
\begin{osservazione}
Questo flusso fa evolvere superfici convesse in un punto. Superfici
non covesse durante l'evoluzione possono dividersi prima di diventare
convesse come descritto in \cite[][]{gui:sapiro}. Facciamo alcuni
semplici esempi. 
\end{osservazione}

\begin{esempio}[The Sphere]
Calcoliamo la soluzione esatta nel caso della sfera che si evolve secondo  \eqref{eq:cp-123}. Sia $\mathcal{S}(p,t) = S^2(R(t))$, cioè una famiglia di sfere in $\mathbb{R}^3$ di raggio $R(t)$ e centro l'origine, e $\mathcal{S}(p,0) = S^2(R_0)$ il nostro dato iniziale. Calcoliamoci la curvatura media, utilizzando l'espressione \eqref{eq:cp1-1-07} e ricordando che la normale interna alla sfera è $\vec{n}(x(t))=-\frac{x(t)}{|x(t)|}$ con $x(t)\in S^2(R(t))$:
\[
H(x(t)) =-\Div(\vec{n}(x(t))=\Div\left(\frac{x(t)}{|x(t)|}\right)=\frac{2}{R(t)}.   
\]
Allora la nostra equazione \eqref{eq:cp-123} diventa:
\[
\overset{\displaystyle.}{R}(t)=-\frac{2}{R(t)}, \text{ con } R(0) = R_0,
\]
risolvendo otteniamo:
\[
R(t)=\sqrt{R_0^2-4t}.
\]
Notiamo che:
\[
R(\hat{t})=0 \Longleftrightarrow \hat{t}=\frac{R_0^2}{4}.
\]
Quindi la sfera si ridurrà ad un punto in un tempo finito $\hat{t}$, che è chiamato tempo di collasso (figura \ref{fig:cp-121}).

\begin{figure}[!htbp]
  \begin{center}
  \tdplotsetmaincoords{60}{40}
  \begin{tikzpicture}[tdplot_main_coords,gray,thick]
   
    \coordinate (O) at (0,0,0);
       
    \tdplotsetcoord{P}{2.0}{90}{45};
    \tdplotsetcoord{P2}{5.5}{90}{45};
    \tdplotsetcoord{P3}{5.5}{90}{40};
    
    \draw [->,Mahogany!80!Mulberry](P) to[out=50,in=130](P2);
    \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
    (origin) at (O) {};
    \node [Mahogany!80!Mulberry,left] at (origin.south) {$O$};
    \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=2mm]
    (end) at (P3) {};
    \node [Mahogany!80!Mulberry,below] at (end.south) {$O$};

    \draw  [tdplot_main_coords,dashed] (O) ellipse (42pt and 20pt);
    \tdplotsetthetaplanecoords{40};
    \draw [thick,tdplot_rotated_coords](1.5,0,0) arc (0:360:1.5);
    
        
  \end{tikzpicture}
  \end{center}
  \caption{Evoluzione della sfera di raggio $R$, per curvatura media}
  \label{fig:cp-121}
\end{figure}
\end{esempio}

\begin{esempio}[The Dumbbell]
Il manubrio(dumbbell) può essere considerato come due spfere di raggio
uguale, connesse da un cilindro. Assumendo che le due sfere sono molto grandi ed il cilindro lungo e fino; l'evoluzione per curvatura media fa collassare velocemente il cilindro in una linea e le due sfere si evolvono più lentamente sempre in sfere più piccole. Dopo un certo tempo il manubrio si divide in due sfere disconnesse, in questa situazione si è verificato un cambiamento della topologia della superficie e quindi non si può più parlare di vettore normale e di curvatura. A questo punto le due sfere si evolvono separatamente fin a collassare in due punti (ved figura \ref{fig:cp-122}). 

\begin{figure}[!hptb]
\begin{center}
 \tdplotsetmaincoords{60}{40}
 \begin{tikzpicture}[tdplot_main_coords,gray,thick]
   
   \coordinate (O) at (0,0,0);
      
   \tdplotsetcoord{P}{3.5}{90}{5};
   \tdplotsetcoord{P2}{5.5}{90}{-30};
   \tdplotsetcoord{P3}{7.5}{90}{40};
   
   \draw [->,Mahogany!80!Mulberry](P) to[out=190,in=150](P2);
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (origin) at (O) {};
   \node [Mahogany!80!Mulberry,below] at (origin.south) {$O$};
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (end) at (P3) {};
   \node [Mahogany!80!Mulberry,below] at (end.south) {$P$};

   \draw  [tdplot_main_coords,dashed] (O) ellipse (42pt and 20pt);
   \tdplotsetthetaplanecoords{40};
   \draw [thick,tdplot_rotated_coords](1.5,0,0) arc (0:360:1.5);

   \draw  [tdplot_main_coords,dashed] (P3) ellipse (42pt and 20pt);
   \tdplotsetthetaplanecoords{40};
   \draw [tdplot_rotated_coords] (P3) circle (1.5);
  
   \draw (1.8,0,0.2) -- (5.4,3.0,0.2);
   \draw (1.9,0,1.2) -- (5.5,2.9,1.2);
        
 \end{tikzpicture}


 \tdplotsetmaincoords{60}{40}
 \begin{tikzpicture}[tdplot_main_coords,gray,thick]
   
   \coordinate (O) at (0,0,0);
      
   \tdplotsetcoord{P}{2.0}{90}{10};
   \tdplotsetcoord{P2}{3.5}{90}{-30};
   \tdplotsetcoord{P3}{7.5}{90}{40};
   
   \draw [->,Mahogany!80!Mulberry](P) to[out=190,in=150](P2);
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (origin) at (O) {};
   \node [Mahogany!80!Mulberry,below] at (origin.south) {$O$};
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (end) at (P3) {};
   \node [Mahogany!80!Mulberry,below] at (end.south) {$P$};

   \draw  [tdplot_main_coords,dashed] (O) ellipse (22pt and 5pt);
   \tdplotsetthetaplanecoords{40};
   \draw [tdplot_rotated_coords](O) circle (0.8);

   \draw  [tdplot_main_coords,dashed] (P3) ellipse (22pt and 5pt);
   \tdplotsetthetaplanecoords{40};
   \draw [tdplot_rotated_coords] (P3) circle (0.8);
  
   \draw (1.0,0.0,0.4) -- (6.2,3.0,1.0);
        
 \end{tikzpicture}

 \tdplotsetmaincoords{60}{40}
 \begin{tikzpicture}[tdplot_main_coords,gray,thick]
   
   \coordinate (O) at (0,0,0);
      
   \tdplotsetcoord{P}{2.0}{90}{45};
   \tdplotsetcoord{P2}{4.5}{90}{45};
   \tdplotsetcoord{P3}{3.0}{90}{40};
   \tdplotsetcoord{P4}{6.5}{90}{45};
   \tdplotsetcoord{P5}{6.7}{90}{40};
   \tdplotsetcoord{P6}{8.0}{90}{40};

   \draw [->,Mahogany!80!Mulberry](P2) to[out=50,in=130](P4);
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (origin) at (O) {};
   \node [Mahogany!80!Mulberry,below] at (origin.south) {$O$};
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=1mm]
   (end) at (P3) {};
   \node [Mahogany!80!Mulberry,below] at (end.south) {$P$};
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=2mm]
   (end) at (P5) {};
   \node [Mahogany!80!Mulberry,below] at (end.south) {$0$};
   \node[shape=circle,draw=gray,fill=gray,inner sep=0pt,minimum size=2mm]
   (end) at (P6) {};
   \node [Mahogany!80!Mulberry,below] at (end.south) {$P$};

   \draw  [tdplot_main_coords,dashed] (O) ellipse (13pt and 5pt);
   \tdplotsetthetaplanecoords{40};
   \draw [tdplot_rotated_coords](O) circle (0.5);

   \draw  [tdplot_main_coords,dashed] (P3) ellipse (13pt and 5pt);
   \tdplotsetthetaplanecoords{40};
   \draw [tdplot_rotated_coords] (P3) circle (0.5);
      
 \end{tikzpicture}
\end{center}
  \caption{Evoluzione del dumbbell  per curvatura media}
  \label{fig:cp-122}
\end{figure}
\end{esempio}
Questi due esempi ci confermano quanto detto sopra, cioè superfici convesse collassano in un punto e superfici non convesse posso generare delle discontinuità, vediamo come aggirare questi due problemi. 

Partiamo dal primo. Quello che vogliamo fare è normalizzare l'equazione \eqref{eq:cp-123} così che il volume vega preservato. Tale processo di normalizzazione, viene raggiunto cambiando la scala temporale, passando da $t$ a $\tau$, in modo tale che la nostra superficie diventi:
\[
\mathcal{\tilde{S}}(\tau):=\psi(t)\mathcal{S}(t),
\]
con $\psi(t)$ rappresentante il fattore di normalizzazione (\emph{time-scaling}) dato da:
\[
\psi^n(t) = \frac{\partial \tau}{\partial t},
\]
con $n$ tale che $\psi^{-n+1}(t)H=\tilde{H}$. Uno dei vantaggi di questa normalizzazione è che le due superfici hanno la stesse proprietà geometriche e quindi il loro comportamento è identico. Il nuovo tempo $\tau$ deve essere scelto in modo da ottenere $V_{\tau}\equiv 0$. Ricordando che la nostra superficie $\mathcal{S}(t)$ si evolve secondo l'equazione \eqref{eq:cp-123}, allora otteniamo la seguente evoluzione per $\mathcal{\tilde{S}}(\tau)$ : 
\[
\begin{aligned}
  &\frac{\partial\mathcal{\tilde{S}}(\tau)}{\partial\tau} =  \frac{\partial\mathcal{\tilde{S}}(t(\tau))}{\partial\tau} = \frac{\partial t}{\partial\tau}\frac{\partial\mathcal{\tilde{S}}(t(\tau))}{\partial t} =\\
  &=\psi^{-n}\left(\psi_t\mathcal{S}+\psi\mathcal{S}_t\right)=\psi^{-n}\psi_t\mathcal{S}+\psi^{-n+1}H\vec{n}=\\
  &=\psi^{-n}\psi_t\mathcal{S}+\tilde{H}\vec{n}=\psi^{-n-1}\psi_t\mathcal{\tilde{S}}+\tilde{H}\vec{n}.
\end{aligned}
\]

Poichè la geometria dell'evolulzione è influenzata solo dalla componente normale della velocità, utilizzando il \emph{Lemma} \ref{lemm:cp-121} otteniamo:
\[
\frac{\partial\mathcal{\tilde{S}}(\tau)}{\partial\tau}=\psi^{-n-1}\psi_t\left<\mathcal{\tilde{S}}(\tau),\vec{n}\right>\vec{n}+\tilde{H}\vec{n}.
\]
Definiamo la funzione supporto $\rho$ come:
\[
\rho:=-\left<\mathcal{S},\vec{n}\right>,
\]
allora
\[
\frac{\partial\mathcal{\tilde{S}}(\tau)}{\partial\tau}=\left(-\psi^{-n-1}\psi_t\tilde{\rho}+\tilde{H}\right)\vec{n}.
\]
Ricordando che, se una superficie evolve secondo un'equazione del tipo
\[
\frac{\partial \mathcal{S}}{\partial t}=\beta\vec{n},
\]
allora il tasso di cambiamento del volume è dato da
\begin{equation}
\label{eq:cp-124}
\frac{d V}{d t}=-\iint\beta d\mu
\end{equation}
con $d\mu$ elemento infinitesimo di superficie, (vedere
\emph{Osservazione} \ref{oss:cp-122}).  Applicando la \eqref{eq:cp-124}
giungiamo a: 
\[
\tilde{V}_{\tau}=\iint(\psi^{-n-1}\psi_t\tilde{\rho}-\tilde{H})d\tilde{\mu},
\]
se noi richiediamo che $\tilde{V}_{\tau}\equiv 0$, allora:
\[
\psi^{-n-1}\psi_t\iint\tilde{\rho}d\mu = \iint\tilde{H}d\tilde{\mu}.
\]
 Tenendo presente che il volume di una superficie è pari a:
\begin{equation}
  \label{eq:cp-125}
V=\frac{1}{3}\iint-\left<\mathcal{S},\vec{n}\right>d\mu,
\end{equation}
con $\vec{n}$ che indica la normale interna (ved \emph{Osservazione} \ref{oss:cp-121}), e che rimane costante nel tempo (come da noi richiesto) possiamo scrivere:
\[
V(0)=\tilde{V}(\tau)=\frac{1}{3}\iint\tilde{\rho}d\tilde{\mu};
\]
mettendo insieme questa con l'espressione precedente otteniamo:
\[
\psi^{-n-1}\psi_t=\frac{\iint\tilde{H}d\tilde{\mu}}{3V_0},
\]
e finalmente otteniamo l'equazione \emph{volume preserving} cercata:
\begin{equation}
\label{eq:cp-126}
\frac{\partial\mathcal{\tilde{S}}(\tau)}{\partial\tau}=\left(\tilde{H}-\frac{\tilde{\rho}\iint\tilde{H}d\tilde{\mu}}{3V_0}\right).
\end{equation}
\begin{osservazione}[Calcolo del Volume]
\label{oss:cp-121}
Vediamo da dove deriva l'espressione \eqref{eq:cp-125}. Prendiamo un insieme $\Omega\subset\mathbb{R}^3$ limitato, la cui frontiera è costituita da una superficie regolare e orientabile, ed un campo vettoriale $F$ regolare in esso, allora vale il \emph{Teorema della Divergenza} cioè:
\[
\int_{\Omega}\Div{F(x)}dV =\int_{\partial\Omega}\left<F(x),\vec{n}(x)\right>d\mu
\]
dove $\vec{n}(x)$, in tal caso, indica la normale esterna e $dV$,$d\mu$ rispettivamente elemento di volume ed elemento di superficie. Prendiamo come campo vettoriale $F(x)=\frac{1}{3}x$, quindi il volume di $\Omega$ è pari a:
\[
vol(\Omega)=\int_{\Omega}1dV=\int_{\Omega}\Div{(F(x))}dV=\frac{1}{3}\int_{\partial\Omega}\left<x,\vec{n}\right>d\mu,
\]
essendo l'ultimo integrale fatto su $\partial\Omega$, il vettore $x$ rappresenta un punto della supeficie, quindi equivale a \eqref{eq:cp-125}.
\end{osservazione}

\begin{osservazione}[Tasso di variazione del Volume]
\label{oss:cp-122}
Cerchiamo di dare una spiegazione all'equazione \eqref{eq:cp-124}. Partiamo da una superficie $\Gamma$ regolare immersa orientabile chiusa in $\mathbb{R}^3$
e una funzione regolare $\gamma=\gamma(x,\vec{n},H)$, che dipende dal punto di superficie $x$, dalla normale unitaria $\vec{n}$ e dalla curvatura media $H$.
Consideriamo un dominio $\mathcal{D}$ che contiene la superficie $\Gamma$ ed un campo vettoriale $\vec{V}$ definito su $\mathcal{D}$, il quale definisce la seguenza continua di superfici perturbate $\left\{\Gamma_t\right\}_{t\ge 0}$ con $\Gamma_0:=\Gamma$. Ed ogni punto $x\in \Gamma_0$ è deformato da un equazione differenziale ordinaria definita dal campo $\vec{V}$:
\[
\frac{dx}{dt}=\vec{V}(x(t)),\quad \forall t\in[0,T],\quad x(0)=X\in\Gamma_0=\Gamma.
\]
Ora prendiamo il seguente funzionale $J(\Gamma)$:
\[
J(\Gamma) = \int_{\Gamma}\gamma(x,\vec{n},H)dS,
\]
si definisce \emph{shape derivate} o derivata Euleriana di $J(\Gamma)$ in $\Gamma$ nella direzione del campo vettoriale $\vec{V}$ il limite
\[
dJ(\Gamma;\vec{V}) = \lim_{t\to 0}\frac{1}{t}(J(\Gamma_t)-J(\Gamma)).
\]
Per ottenere la \eqref{eq:cp-124} dobbiamo calcolarci questa shape
derivate e per farlo useremo il \emph{Corollario} 4.1 dell'articolo \cite[][]{dog:noch} con $\gamma$ dipendente solo dal punto $x$ e dalla normale unitaria $\vec{n}$: 
\begin{equation}
\label{eq:cp-121-add}
\gamma(x,\vec{n})=-\frac{1}{3}<\mathcal{S},\vec{n}> = -\frac{1}{3}\sum_{i=1}^3x_in_i.
\end{equation}
Secondo tale corollario otteniamo:
\[
dJ(\Gamma;\vec{V}) = \int_{\Gamma}(H\gamma+\partial_{n}\gamma+\Div_{\Gamma}[\gamma_y]_{\Gamma})VdS.
\]
dove:
\begin{itemize}
  \item $\partial_n\gamma=<D_x\gamma,\vec{n}>$, sarebbe la derivata partiale rispetto ad $x$ nella direzione della normale;
  \item $\gamma_y=D_n\gamma$, indica il grandiente di $\gamma$ rispetto alla normale;
  \item $[\cdot]_{\Gamma}$, rappresenta la proiezione sul piano tangente;
  \item $\Div_{\Gamma}\vec{W}=\left(\Div\vec{W}-\vec{n}\cdot D\vec{W} \cdot \vec{n}\right)_{|\Gamma}$, denota la divergenza tangenziale di $\vec{W}$, propriamente esteso in un intorno di $\Gamma$;
  \item $\Div_{\Gamma}[\gamma_y]_{\Gamma}=\Div_{\Gamma}[\gamma_y]-H<\gamma_y,\vec{n}>$, con $\Div_{\Gamma}[\gamma_y]$ calcolata nel \emph{Lemma} 3.3 di \cite[][]{dog:noch};
  \item $V=<\vec{V},\vec{n}>$, componente normale del campo vettoriale.
\end{itemize}
Calcolandoci queste quantità per $\gamma$ pari a \eqref{eq:cp-121-add} e ricordando che nel nostro caso la componente normale del campo è $\beta$,  otteniamo:
\[
dJ(\Gamma;\vec{V})=\int_{\Gamma}(H\gamma -\frac{1}{3} -1 +\frac{1}{3} -H\gamma)\beta dS=-\int_{\Gamma}\beta dS.
\]
\end{osservazione}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
% Section 1.3 
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Approccio \emph{level-set}}  

Nella sezione precedente abbiamo visto come risolvere il problema del collasso, cioè evitare che in un tempo finito il volume diventa nullo. Tuttavia quando si implementa numericamente tale flusso, ci si imbatte in altri problemi:
\begin{itemize}

  \item Il nostro algoritmo deve essere robusto in quanto deve approssimare un flusso continuo. Una semplice approssimazione Lagrangiana basata sulle particelle che si muovono lungo la superficie richiederebbe un passo temporale impraticabile, poichè le particelle possono trovarsi molto vicine o molto lontane durante la deformazione.

   \item Lo svilupparsi di singolarità, è un altro problema che dobbiamo tener presente. Quindi abbiamo bisogno di uno schema che trovi ,in tal caso, la corretta soluzione debole.
   
   \item Cambiamenti topologici possono verificarsi (fusione o divisione) e tener traccia di questi con tracciamenti di particelle è un compito alquano arduo.

\end{itemize}

Tutti questi problemi hanno portato allo svilupparsi di tecniche \emph{level-set}. Alla base di questo approccio c'è l'idea di vedere la nostra superficie come  insieme di livello di una funzione. Utilizziamo la rappresentazione introdotta in §\ref{sec:cp1-00} con $S_t$ una superfice regolare che si evolve nel tempo in qualche intervallo temporale. Consideriamo una curva $x(t)$ in $\mathbb{R}^3$ su $S_t$ definita in $(t-\delta,t+\delta)$, con $\delta>0$ tale che $x(t)\in S_t$ e $x(t_0)=x_0$. Dalla definizione di $S_t$ deve essere $u(x(t),t)=0$ per $t$ vicino a $t_0$, quindi differenziando  $u(x(t),t)$ ed evalutandola nel punto $(x_0,t_0)$ otteniamo:
\[
u_t(x_0,t_0)+\left<\frac{dx}{dt}(t_0),Du(x_0,t_0)\right>=0,
\]
ricordando che la normale $\vec{n}=-\frac{Du}{|Du|}$, abbiamo:
\[
u_t(x_0,t_0)-|Du(x_0,t_0)|\left<\frac{dx}{dt}(t_0),\vec{n}\right>=0.
\]
Il prodotto scalare che compare nell'espressione precedente rappresenta la velocità normale di $S_t$ nel punto $x_0$ al tempo $t_0$ per cui: 
\[
V=\frac{u_t(x_0,t_0)}{|Du(x_0,t_0)|},
\]
chiaramente  $V$ non dipende dalla scelta della curva $x(t)$. Poichè nel moto per curvatura media la velocità normale è uguale alla curvatura media otteniamo:
\begin{equation}
  \label{eq:cp-131}
  u_t(x,t)=|Du(x,t)|\Div{\left(\frac{D(x,t)}{|D(x,t)|}\right)}
\end{equation}
che rappresenta la formulazione level-set dell'equazione \eqref{eq:cp-123}. 
Quindi, ricapitolando, quando una funzione si muove secondo la \eqref{eq:cp-131}, i suoi insiemi di livello si muovono secondo la \eqref{eq:cp-123}. Inseriamo anche il termine che preserva il volume:
\begin{equation}
  \label{eq:cp-132}
  u_t(x,t)=|Du(x,t)|\Div{\left(\frac{D(x,t)}{|D(x,t)|}\right)}-\frac{\iint\Div{\left(\frac{D(x,t)}{|D(x,t)|}\right)}d\mu}{3V_0}x^tDu
\end{equation}
 Tale formulazione ci consente di superare i problemi messi in risalto ad inizio paragrafo, infatti:
\begin{itemize}
  \item Riusciamo a risolver il problema di creare un metodo robusto e stabile, in quanto la formulazione level-set è scritta in un sistema di coordinate fisso quindi non dobbiamo tener traccia di come evolvono tutte le particelle.

  \item L'emrgere di discontinuità viene risolto utilizzando la teoria viscosa, in quanto è stato dimostrata per alcune velocità (tra cui anche quella presa in esame da noi) l'esistenza e l'unicità di soluzioni viscose per il flusso level-set.

   \item I cambiamenti topologici della superficie non sono più un problema, poichè la topologia di $u$ è fissa. Tali cambiamenti vengono scoperti solo quando viene calcolato il corrispondente insieme di livello. 

\end{itemize}
